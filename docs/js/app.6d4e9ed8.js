(function(t){function e(e){for(var i,o,c=e[0],a=e[1],l=e[2],h=0,d=[];h<c.length;h++)o=c[h],r[o]&&d.push(r[o][0]),r[o]=0;for(i in a)Object.prototype.hasOwnProperty.call(a,i)&&(t[i]=a[i]);u&&u(e);while(d.length)d.shift()();return n.push.apply(n,l||[]),s()}function s(){for(var t,e=0;e<n.length;e++){for(var s=n[e],i=!0,c=1;c<s.length;c++){var a=s[c];0!==r[a]&&(i=!1)}i&&(n.splice(e--,1),t=o(o.s=s[0]))}return t}var i={},r={1:0},n=[];function o(e){if(i[e])return i[e].exports;var s=i[e]={i:e,l:!1,exports:{}};return t[e].call(s.exports,s,s.exports,o),s.l=!0,s.exports}o.m=t,o.c=i,o.d=function(t,e,s){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(o.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)o.d(s,i,function(e){return t[e]}.bind(null,i));return s},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],a=c.push.bind(c);c.push=e,c=c.slice();for(var l=0;l<c.length;l++)e(c[l]);var u=a;n.push([4,0]),s()})({4:function(t,e,s){t.exports=s("zUnb")},"9mAT":function(t,e,s){"use strict";var i=s("T069"),r=s.n(i);r.a},KLYr:function(t,e,s){},T069:function(t,e,s){},"Z/zX":function(t,e,s){"use strict";var i=s("a8N2"),r=s.n(i);r.a},a8N2:function(t,e,s){},bnnc:function(t,e,s){"use strict";var i=s("hNEx"),r=s.n(i);r.a},f1gQ:function(t,e,s){"use strict";"serviceWorker"in navigator&&window.addEventListener("load",function(){navigator.serviceWorker.register("./service-worker.js")})},hNEx:function(t,e,s){},upXe:function(t,e,s){"use strict";var i=s("KLYr"),r=s.n(i);r.a},zUnb:function(t,e,s){"use strict";s.r(e);s("VRzm"),s("f1gQ"),s("201c");var i=s("Kw5r"),r=s("L2JU"),n=(s("Vd3H"),{namespaced:!0,state:{listScore:[],indexScore:-1},getters:{getScore:function(t){var e=t.listScore;return e.length?e:JSON.parse(localStorage.getItem("score")||"[]")},getProgress:function(){return JSON.parse(localStorage.getItem("progress")||"{}")}},actions:{setScore:function(t,e){var s=t.state,i=t.getters,r=e.score,n=e.lines,o={score:r,lines:n};s.listScore=i.getScore,s.listScore.push(o),s.listScore.sort(function(t,e){return e.score-t.score}).splice(5),s.indexScore=s.listScore.indexOf(o),localStorage.setItem("score",JSON.stringify(s.listScore))},setProgress:function(t,e){t.commit,t.state,t.getters;localStorage.setItem("progress",JSON.stringify(e))}}});i["default"].use(r["a"]);var o=new r["a"].Store({modules:{progress:n}}),c=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"app"}},[s("main",[s("tetris")],1),s("div",{staticClass:"overlay-bg"})])},a=[],l=s("xmWZ"),u=s("3Aqn"),h=s("0yhX"),d=s("EdlT"),v=s("mrSG"),f=s("YKMj"),g=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"tetris"},[t.isLandscape?s("div",{staticClass:"landscape"},[t._v("\n    Turn me, please\n  ")]):[t.isShowGame?[s("div",{staticClass:"header"},[s("div",{staticClass:"menu",on:{click:function(e){e.preventDefault(),t.isPause=!0}}},[t._v("≡")]),s("div",{staticClass:"score"},[s("div",[t._v(t._s(t.stat.score)+" / "+t._s(t.stat.lines))])]),s("div",{staticClass:"mini-grid"},t._l(t.block.next,function(e,i){return s("div",{key:i,staticClass:"mini-grid-row"},t._l(e,function(e,i){return s("div",{key:i,staticClass:"mini-grid-cell",class:(r={},r[t.color.next]=e,r)});var r}))}))]),s("div",{staticClass:"main"},[s("div",{staticClass:"grid"},t._l(t.grid,function(e,i){return s("div",{key:i,staticClass:"grid-row"},t._l(e,function(t,e){return s("div",{key:e,staticClass:"grid-cell",class:(i={},i[t.color]=t.state,i)});var i}))}))]),s("div",{staticClass:"footer"},[s("div",{staticClass:"nav-arrow",on:{touchstart:function(e){e.preventDefault(),t.touchStart(e,t.toLeft)},touchend:t.touchEnd}},[t._v("←")]),s("div",{staticClass:"nav-arrow",on:{touchstart:function(e){e.preventDefault(),t.touchStart(e,t.toRight)},touchend:t.touchEnd}},[t._v("→")]),s("div",{staticClass:"nav-arrow",on:{click:function(e){return e.preventDefault(),t.rotateBlock(e)}}},[t._v("↑")]),s("div",{staticClass:"nav-arrow",on:{touchstart:function(e){e.preventDefault(),t.touchStart(e,t.toDown)},touchend:t.touchEnd}},[t._v("↓")])])]:t._e(),t.isPause?s("tetris-menu",{attrs:{"has-game-progress":t.hasGameProgress},on:{"tetris:new-game":t.onClickNewGame,"tetris:resume":t.onClickResume}}):t._e()]],2)},p=[],b=s("iv4g"),k=(s("rGqo"),s("yt8O"),s("RW0V"),s("qpph")),m=s("S7WH"),y=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"tetris-menu"},[s("div",{staticClass:"box"},[s("h1",[t._v("Classic Tetris")]),t._l(t.buttons,function(e){return e.isShow?s("button",{class:e.class,on:{click:e.click}},[t._v("\n      "+t._s(e.name)+"\n    ")]):t._e()}),t.isShow||t.isNewHighscore()?s("div",{staticClass:"highscores"},[t.getScore.length?[s("div",{staticClass:"cell-number head-title"},[t._v("#")]),s("div",{staticClass:"cell-score head-title"},[t._v("score")]),s("div",{staticClass:"cell-lines head-title"},[t._v("lines")]),t._l(t.getScore,function(e,i){return s("div",{staticClass:"row-score",class:{"-active":i===t.indexScore&&t.isNewHighscore()}},[s("div",{staticClass:"cell-number"},[t._v(t._s(i+1))]),s("div",{staticClass:"cell-score"},[t._v(t._s(e.score))]),s("div",{staticClass:"cell-lines"},[t._v(t._s(e.lines))])])})]:s("div",{staticClass:"empty"},[t._v("\n        is empty\n      ")])],2):t._e()],2),s("div",{staticClass:"overlay"})])},w=[],S=Object(m["a"])("progress"),O=function(t){function e(){var t;return Object(l["a"])(this,e),t=Object(h["a"])(this,Object(d["a"])(e).apply(this,arguments)),t.isShow=!1,t.buttons=[{name:"Resume",class:"btn-green",isShow:t.hasGameProgress,click:t.onClickResume},{name:"New game",class:t.hasGameProgress?"btn-orange":"btn-green",isShow:!0,click:t.onClickNewGame},{name:"Highscores",class:"btn-blue",isShow:!0,click:t.onClickHighscores}],t}return Object(k["a"])(e,[{key:"onClickResume",value:function(){this.$emit("tetris:resume")}},{key:"onClickNewGame",value:function(){this.$emit("tetris:new-game")}},{key:"onClickHighscores",value:function(){this.isShow=!this.isShow}},{key:"isNewHighscore",value:function(){return!!this.getScore[this.indexScore]}}]),Object(u["a"])(e,t),e}(f["c"]);v["a"]([Object(f["b"])(),v["b"]("design:type",Boolean)],O.prototype,"hasGameProgress",void 0),v["a"]([S.State,v["b"]("design:type",Object)],O.prototype,"indexScore",void 0),v["a"]([S.Getter,v["b"]("design:type",Object)],O.prototype,"getScore",void 0),O=v["a"]([Object(f["a"])({name:"TetrisMenu"})],O);var x=O,_=x,j=(s("upXe"),s("KHd+")),C=Object(j["a"])(_,y,w,!1,null,"6bb0b6d4",null),P=C.exports,I=P,E=Object(m["a"])("progress"),G=function(t){function e(){var t;return Object(l["a"])(this,e),t=Object(h["a"])(this,Object(d["a"])(e).apply(this,arguments)),t.rows=20,t.cells=10,t.rowIndex=-1,t.cellIndex=0,t.grid=[],t.isPause=!0,t.hasGameProgress=!1,t.isShowGame=!1,t.isLandscape=!1,t.stat={score:0,lines:0},t.color={current:"",next:""},t.colors=["cell-green","cell-red","cell-blue","cell-orange"],t.block={current:[],next:[],process:[]},t.blocks=[[[1,1,1,1]],[[0,1,0],[1,1,1]],[[1,1,0],[0,1,1]],[[0,1,1],[1,1,0]],[[1,0,0],[1,1,1]],[[0,0,1],[1,1,1]],[[1,1],[1,1]]],t}return Object(k["a"])(e,[{key:"created",value:function(){this.bindEvents();var t=this.getProgress;Object.keys(t).length&&(this.hasGameProgress=!0,this.isShowGame=!0,this.stat=t.stat,this.block=t.block,this.color=t.color,this.grid=t.grid)}},{key:"createGrid",value:function(){this.grid=[];for(var t=0;t<this.rows;t++){this.grid.push([]);for(var e=0;e<this.cells;e++)this.grid[t].push({state:0,color:""})}}},{key:"onKeyDown",value:function(t){if(!this.isPause)switch(t.keyCode){case 37:this.toLeft();break;case 39:this.toRight();break;case 40:this.toDown();break;case 38:this.rotateBlock();break;case 32:this.isPause=!0;break}}},{key:"isFirstStep",value:function(){return!this.block.process.length}},{key:"go",value:function(){var t=this,e=[],s=0;return this.isFirstStep()&&(this.cellIndex=Math.floor((this.cells-this.block.current[0].length)/2)),this.block.current.forEach(function(i,r){i.forEach(function(i,n){if(i){var o=t.rowIndex+r,c=t.cellIndex+n;s++,t.grid[o]&&t.grid[o][c]&&-1!==t.grid[o][c].state&&e.push([o,c])}})}),s===e.length&&(this.block.process.forEach(function(e){return t.grid[e[0]][e[1]].state=0}),e.forEach(function(e){t.grid[e[0]][e[1]].color=t.color.current,t.grid[e[0]][e[1]].state=1}),this.block.process=e,!0)}},{key:"toDown",value:function(){var t=this,e=0;if(this.rowIndex++,!this.go()){if(this.isFirstStep())return this.touchEnd(),this.stat.score&&this.setScore(this.stat),this.setProgress({}),this.hasGameProgress=!1,void(this.isPause=!0);this.block.process.forEach(function(e){return t.grid[e[0]][e[1]].state=-1}),this.block.process.forEach(function(s){t.grid[s[0]]&&10===t.grid[s[0]].filter(function(t){return-1===t.state}).length&&(e++,t.stat.score+=(s[0]+1)*e,t.grid[s[0]].forEach(function(t){return t.state=0}),t.grid.unshift(t.grid.splice(s[0],1)[0]))}),this.stat.lines+=e,this.setDefaultOptions(),this.setProgress({stat:this.stat,block:this.block,color:this.color,grid:this.grid}),this.toDown()}}},{key:"toLeft",value:function(){this.cellIndex--,this.go()||this.cellIndex++}},{key:"toRight",value:function(){this.cellIndex++,this.go()||this.cellIndex--}},{key:"rotateBlock",value:function(){var t,e,s=[];if(this.block.process.length){Object(b["a"])(this.block.current).reverse().forEach(function(t){t.forEach(function(t,e){s[e]||(s[e]=[]),s[e].push(t)})});var i=(s.length-this.block.current.length)/2;t=this.cellIndex,e=this.block.current,this.cellIndex+=i>0?Math.floor(i):Math.ceil(i),this.block.current=s,this.go()||(this.cellIndex=t||this.cellIndex,this.block.current=e||this.block.current)}}},{key:"setDefaultOptions",value:function(){this.block.process=[],this.rowIndex=-1,this.cellIndex=0,this.color.current&&this.block.current||this.setNextParams(),this.color.current=this.color.next,this.block.current=this.block.next,this.setNextParams()}},{key:"setNextParams",value:function(){this.color.next=this.colors[this.getRandomInt(0,this.colors.length)],this.block.next=this.blocks[this.getRandomInt(0,this.blocks.length)]}},{key:"getRandomInt",value:function(t,e){return Math.floor(Math.random()*(e-t))+t}},{key:"onClickNewGame",value:function(){this.isPause=!1,this.hasGameProgress=!0,this.isShowGame=!0,this.color.current="",this.stat.score=0,this.stat.lines=0,this.createGrid(),this.setDefaultOptions(),this.setProgress({})}},{key:"onClickResume",value:function(){this.isPause=!1}},{key:"touchStart",value:function(t,e){1===t.touches.length&&(e(),this.intervalId=setInterval(e,100))}},{key:"touchEnd",value:function(){clearInterval(this.intervalId)}},{key:"checkOrientation",value:function(){this.isLandscape=90===Math.abs(window.orientation)}},{key:"bindEvents",value:function(){var t=this;document.addEventListener("keydown",this.onKeyDown),window.addEventListener("blur",function(){return t.isPause=!0}),window.addEventListener("orientationchange",this.checkOrientation),this.checkOrientation()}},{key:"handler",value:function(t){var e=this;t?clearInterval(this.gameIntervalId):(this.$nextTick(function(){return e.toDown()}),this.gameIntervalId=setInterval(this.toDown,500))}}]),Object(u["a"])(e,t),e}(f["c"]);v["a"]([E.Getter,v["b"]("design:type",Object)],G.prototype,"getProgress",void 0),v["a"]([E.Getter,v["b"]("design:type",Object)],G.prototype,"getScore",void 0),v["a"]([E.Action,v["b"]("design:type",Object)],G.prototype,"setProgress",void 0),v["a"]([E.Action,v["b"]("design:type",Object)],G.prototype,"setScore",void 0),v["a"]([Object(f["d"])("isPause",{immediate:!0}),v["b"]("design:type",Function),v["b"]("design:paramtypes",[Boolean]),v["b"]("design:returntype",void 0)],G.prototype,"handler",null),G=v["a"]([Object(f["a"])({name:"Tetris",components:{TetrisMenu:I}})],G);var N=G,D=N,T=(s("9mAT"),Object(j["a"])(D,g,p,!1,null,"3a3998b4",null)),L=T.exports,M=L,R=function(t){function e(){return Object(l["a"])(this,e),Object(h["a"])(this,Object(d["a"])(e).apply(this,arguments))}return Object(u["a"])(e,t),e}(f["c"]);R=v["a"]([Object(f["a"])({components:{Tetris:M}})],R);var H=R,J=H,K=(s("bnnc"),s("Z/zX"),Object(j["a"])(J,c,a,!1,null,null,null)),$=K.exports;i["default"].config.productionTip=!1,new i["default"]({store:o,render:function(t){return t($)}}).$mount("#app")}});
//# sourceMappingURL=app.6d4e9ed8.js.map