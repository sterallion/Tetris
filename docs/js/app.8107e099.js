(function(t){function e(e){for(var i,o,c=e[0],a=e[1],l=e[2],h=0,d=[];h<c.length;h++)o=c[h],r[o]&&d.push(r[o][0]),r[o]=0;for(i in a)Object.prototype.hasOwnProperty.call(a,i)&&(t[i]=a[i]);u&&u(e);while(d.length)d.shift()();return n.push.apply(n,l||[]),s()}function s(){for(var t,e=0;e<n.length;e++){for(var s=n[e],i=!0,c=1;c<s.length;c++){var a=s[c];0!==r[a]&&(i=!1)}i&&(n.splice(e--,1),t=o(o.s=s[0]))}return t}var i={},r={app:0},n=[];function o(e){if(i[e])return i[e].exports;var s=i[e]={i:e,l:!1,exports:{}};return t[e].call(s.exports,s,s.exports,o),s.l=!0,s.exports}o.m=t,o.c=i,o.d=function(t,e,s){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(o.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)o.d(s,i,function(e){return t[e]}.bind(null,i));return s},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],a=c.push.bind(c);c.push=e,c=c.slice();for(var l=0;l<c.length;l++)e(c[l]);var u=a;n.push([0,"chunk-vendors"]),s()})({0:function(t,e,s){t.exports=s("cd49")},"043a":function(t,e,s){},"3ec4":function(t,e,s){"use strict";var i=s("6db7"),r=s.n(i);r.a},"6c73":function(t,e,s){"use strict";var i=s("b80b"),r=s.n(i);r.a},"6db7":function(t,e,s){},7113:function(t,e,s){"use strict";var i=s("043a"),r=s.n(i);r.a},"76b5":function(t,e,s){},"7f58":function(t,e,s){"use strict";"serviceWorker"in navigator&&window.addEventListener("load",function(){navigator.serviceWorker.register("./service-worker.js")})},b80b:function(t,e,s){},cd49:function(t,e,s){"use strict";s.r(e);s("cadf"),s("551c"),s("f751"),s("097d"),s("7f58"),s("db4d");var i=s("2b0e"),r=s("2f62"),n=s("f499"),o=s.n(n),c=(s("55dd"),{namespaced:!0,state:{listScore:[],indexScore:-1},getters:{getScore:function(t){var e=t.listScore;return e.length?e:JSON.parse(localStorage.getItem("score")||"[]")},getProgress:function(){return JSON.parse(localStorage.getItem("progress")||"{}")}},actions:{setScore:function(t,e){var s=t.state,i=t.getters,r=e.score,n=e.lines,c={score:r,lines:n};s.listScore=i.getScore,s.listScore.push(c),s.listScore.sort(function(t,e){return e.score-t.score}).splice(5),s.indexScore=s.listScore.indexOf(c),localStorage.setItem("score",o()(s.listScore))},setProgress:function(t,e){t.commit,t.state,t.getters;localStorage.setItem("progress",o()(e))}}});i["default"].use(r["a"]);var a=new r["a"].Store({modules:{progress:c}}),l=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"app",attrs:{id:"app"}},[s("main",{staticClass:"--container"},[s("Tetris")],1),s("div",{staticClass:"--overlay-bg"})])},u=[],h=s("d225"),d=s("308d"),f=s("6bb5"),v=s("4e2b"),g=s("9ab4"),b=s("60a3"),p=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"tetris"},[t.isLandscape?i("div",{staticClass:"--landscape"},[t._v("\n    Turn me, please\n  ")]):[t.isShowGame?[i("div",{staticClass:"--header"},[i("div",{staticClass:"--menu",on:{click:function(e){e.preventDefault(),t.isPause=!0}}},[i("img",{attrs:{src:s("eab1")}})]),i("div",{staticClass:"--score"},[i("div",[t._v(t._s(t.stat.score)+" / "+t._s(t.stat.lines))])]),i("div",{staticClass:"--grid -mini"},t._l(t.block.next,function(e,s){return i("div",{key:s,staticClass:"--row"},t._l(e,function(e,s){var r;return i("div",{key:s,staticClass:"--cell",class:(r={},r[t.color.next]=e,r)})}),0)}),0)]),i("div",{ref:"main",staticClass:"--main"},[i("div",{staticClass:"--grid"},t._l(t.grid,function(e,s){return i("div",{key:s,staticClass:"--row"},t._l(e,function(t,e){var s;return i("div",{key:e,staticClass:"--cell",class:(s={},s[t.color]=t.state,s)})}),0)}),0)]),i("div",{staticClass:"--footer"},[i("div",{staticClass:"--nav-arrow",on:{touchstart:function(e){return e.preventDefault(),t.touchStart(e,t.toLeft)},touchend:t.touchEnd}},[t._v("←")]),i("div",{staticClass:"--nav-arrow",on:{touchstart:function(e){return e.preventDefault(),t.touchStart(e,t.toRight)},touchend:t.touchEnd}},[t._v("→")]),i("div",{staticClass:"--nav-arrow",on:{click:function(e){return e.preventDefault(),t.rotateBlock(e)}}},[t._v("↑")]),i("div",{staticClass:"--nav-arrow",on:{touchstart:function(e){return e.preventDefault(),t.touchStart(e,t.toDown)},touchend:t.touchEnd}},[t._v("↓")])])]:t._e(),t.isPause?i("TetrisMenu",{attrs:{"has-game-progress":t.hasGameProgress},on:{"tetris:new-game":t.onClickNewGame,"tetris:resume":t.onClickResume}}):t._e()]],2)},k=[],m=s("75fc"),y=(s("ac6a"),s("a4bb")),w=s.n(y),S=s("b0b4"),O=s("4bb5"),x=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"tetris-menu"},[s("div",{staticClass:"--box"},[s("h1",[t._v("Classic Tetris")]),t._l(t.buttons,function(e){return e.isShow?s("button",{class:e.class,on:{click:e.click}},[t._v("\n      "+t._s(e.name)+"\n    ")]):t._e()}),t.isShow||t.isNewHighscore?s("div",{staticClass:"--highscores"},[s("div",{staticClass:"--cell-number --head-title"},[t._v("#")]),s("div",{staticClass:"--cell-score --head-title"},[t._v("score")]),s("div",{staticClass:"--cell-lines --head-title"},[t._v("lines")]),t._l(t.getScore,function(e,i){return s("div",{staticClass:"--row-score",class:{"-active":i===t.indexScore&&t.isNewHighscore}},[s("div",{staticClass:"--cell-number"},[t._v(t._s(i+1))]),s("div",{staticClass:"--cell-score"},[t._v(t._s(e.score))]),s("div",{staticClass:"--cell-lines"},[t._v(t._s(e.lines))])])})],2):t._e()],2),s("div",{staticClass:"--overlay"})])},C=[],_=Object(O["a"])("progress"),j=function(t){function e(){var t;return Object(h["a"])(this,e),t=Object(d["a"])(this,Object(f["a"])(e).apply(this,arguments)),t.isShow=!1,t}return Object(v["a"])(e,t),Object(S["a"])(e,[{key:"onClickResume",value:function(){this.$emit("tetris:resume")}},{key:"onClickNewGame",value:function(){this.$emit("tetris:new-game")}},{key:"onClickHighscores",value:function(){this.isShow=!this.isShow}},{key:"buttons",get:function(){return[{name:"Resume",class:"btn-green",isShow:this.hasGameProgress,click:this.onClickResume},{name:"New game",class:this.hasGameProgress?"btn-orange":"btn-green",isShow:!0,click:this.onClickNewGame},{name:"Highscores",class:"btn-blue",isShow:this.getScore.length,click:this.onClickHighscores}]}},{key:"isNewHighscore",get:function(){return!!this.getScore[this.indexScore]}}]),e}(b["c"]);g["a"]([Object(b["b"])(),g["b"]("design:type",Boolean)],j.prototype,"hasGameProgress",void 0),g["a"]([_.State,g["b"]("design:type",Object)],j.prototype,"indexScore",void 0),g["a"]([_.Getter,g["b"]("design:type",Object)],j.prototype,"getScore",void 0),j=g["a"]([Object(b["a"])({name:"TetrisMenu"})],j);var I=j,P=I,E=(s("7113"),s("2877")),G=Object(E["a"])(P,x,C,!1,null,"7f3a46d3",null),D=G.exports,R=D,M=Object(O["a"])("progress"),N=function(t){function e(){var t;return Object(h["a"])(this,e),t=Object(d["a"])(this,Object(f["a"])(e).apply(this,arguments)),t.rows=20,t.cells=10,t.rowIndex=-1,t.cellIndex=0,t.grid=[],t.isPause=!0,t.hasGameProgress=!1,t.isShowGame=!1,t.isLandscape=!1,t.stat={score:0,lines:0},t.color={current:"",next:""},t.colors=["-green","-red","-blue","-orange"],t.block={current:[],next:[],process:[]},t.blocks=[[[1,1,1,1]],[[0,1,0],[1,1,1]],[[1,1,0],[0,1,1]],[[0,1,1],[1,1,0]],[[1,0,0],[1,1,1]],[[0,0,1],[1,1,1]],[[1,1],[1,1]]],t}return Object(v["a"])(e,t),Object(S["a"])(e,[{key:"created",value:function(){var t=this.getProgress;w()(t).length&&(this.hasGameProgress=!0,this.isShowGame=!0,this.stat=t.stat,this.block=t.block,this.color=t.color,this.grid=t.grid)}},{key:"mounted",value:function(){this.bindEvents()}},{key:"createGrid",value:function(){this.grid=[];for(var t=0;t<this.rows;t++){this.grid.push([]);for(var e=0;e<this.cells;e++)this.grid[t].push({state:0,color:""})}}},{key:"onKeyDown",value:function(t){if(!this.isPause)switch(t.keyCode){case 37:this.toLeft();break;case 39:this.toRight();break;case 40:this.toDown();break;case 38:this.rotateBlock();break;case 32:this.isPause=!0;break}}},{key:"isFirstStep",value:function(){return!this.block.process.length}},{key:"go",value:function(){var t=this,e=[],s=0;return this.isFirstStep()&&(this.cellIndex=Math.floor((this.cells-this.block.current[0].length)/2)),this.block.current.forEach(function(i,r){i.forEach(function(i,n){if(i){var o=t.rowIndex+r,c=t.cellIndex+n;s++,t.grid[o]&&t.grid[o][c]&&-1!==t.grid[o][c].state&&e.push([o,c])}})}),s===e.length&&(this.block.process.forEach(function(e){return t.grid[e[0]][e[1]].state=0}),e.forEach(function(e){t.grid[e[0]][e[1]].color=t.color.current,t.grid[e[0]][e[1]].state=1}),this.block.process=e,!0)}},{key:"toDown",value:function(){var t=this,e=0;if(this.rowIndex++,!this.go()){if(this.isFirstStep())return this.touchEnd(),this.stat.score&&this.setScore(this.stat),this.setProgress({}),this.hasGameProgress=!1,void(this.isPause=!0);this.block.process.forEach(function(e){return t.grid[e[0]][e[1]].state=-1}),this.block.process.forEach(function(s){t.grid[s[0]]&&10===t.grid[s[0]].filter(function(t){return-1===t.state}).length&&(e++,t.stat.score+=(s[0]+1)*e,t.grid[s[0]].forEach(function(t){return t.state=0}),t.grid.unshift(t.grid.splice(s[0],1)[0]))}),this.stat.lines+=e,this.setDefaultOptions(),this.setProgress({stat:this.stat,block:this.block,color:this.color,grid:this.grid}),this.toDown()}}},{key:"toLeft",value:function(){this.cellIndex--,this.go()||this.cellIndex++}},{key:"toRight",value:function(){this.cellIndex++,this.go()||this.cellIndex--}},{key:"rotateBlock",value:function(){var t,e,s=[];if(this.block.process.length){Object(m["a"])(this.block.current).reverse().forEach(function(t){t.forEach(function(t,e){s[e]||(s[e]=[]),s[e].push(t)})});var i=(s.length-this.block.current.length)/2;t=this.cellIndex,e=this.block.current,this.cellIndex+=i>0?Math.floor(i):Math.ceil(i),this.block.current=s,this.go()||(this.cellIndex=t||this.cellIndex,this.block.current=e||this.block.current)}}},{key:"setDefaultOptions",value:function(){this.block.process=[],this.rowIndex=-1,this.cellIndex=0,this.color.current&&this.block.current||this.setNextParams(),this.color.current=this.color.next,this.block.current=this.block.next,this.setNextParams()}},{key:"setNextParams",value:function(){this.color.next=this.colors[this.getRandomInt(0,this.colors.length)],this.block.next=this.blocks[this.getRandomInt(0,this.blocks.length)]}},{key:"getRandomInt",value:function(t,e){return Math.floor(Math.random()*(e-t))+t}},{key:"onClickNewGame",value:function(){this.isPause=!1,this.hasGameProgress=!0,this.isShowGame=!0,this.color.current="",this.stat.score=0,this.stat.lines=0,this.createGrid(),this.setDefaultOptions(),this.$nextTick(this.onResize),this.setProgress({})}},{key:"onClickResume",value:function(){this.isPause=!1}},{key:"touchStart",value:function(t,e){1===t.touches.length&&(e(),this.touchIntervalId=setInterval(e,100))}},{key:"touchEnd",value:function(){clearInterval(this.touchIntervalId)}},{key:"checkOrientation",value:function(){this.isLandscape=90===Math.abs(window.orientation)}},{key:"onResize",value:function(){var t=this.$refs.main;t.style.width="".concat(t.offsetHeight/2,"px")}},{key:"bindEvents",value:function(){var t=this;document.addEventListener("keydown",this.onKeyDown),window.addEventListener("blur",function(){return t.isPause=!0}),window.addEventListener("resize",this.onResize),this.onResize(),window.addEventListener("orientationchange",this.checkOrientation),this.checkOrientation()}},{key:"handler",value:function(t){var e=this;t?clearInterval(this.gameIntervalId):(this.$nextTick(function(){return e.toDown()}),this.gameIntervalId=setInterval(this.toDown,500))}}]),e}(b["c"]);g["a"]([M.Getter,g["b"]("design:type",Object)],N.prototype,"getProgress",void 0),g["a"]([M.Getter,g["b"]("design:type",Object)],N.prototype,"getScore",void 0),g["a"]([M.Action,g["b"]("design:type",Object)],N.prototype,"setProgress",void 0),g["a"]([M.Action,g["b"]("design:type",Object)],N.prototype,"setScore",void 0),g["a"]([Object(b["d"])("isPause",{immediate:!0}),g["b"]("design:type",Function),g["b"]("design:paramtypes",[Boolean]),g["b"]("design:returntype",void 0)],N.prototype,"handler",null),N=g["a"]([Object(b["a"])({name:"Tetris",components:{TetrisMenu:R}})],N);var T=N,L=T,$=(s("6c73"),Object(E["a"])(L,p,k,!1,null,"ac76effc",null)),H=$.exports,z=H,B=function(t){function e(){return Object(h["a"])(this,e),Object(d["a"])(this,Object(f["a"])(e).apply(this,arguments))}return Object(v["a"])(e,t),e}(b["c"]);B=g["a"]([Object(b["a"])({components:{Tetris:z}})],B);var F=B,J=F,A=(s("3ec4"),s("fa2d"),Object(E["a"])(J,l,u,!1,null,"0a79066a",null)),K=A.exports;i["default"].config.productionTip=!1,new i["default"]({store:a,render:function(t){return t(K)}}).$mount("#app")},eab1:function(t,e,s){t.exports=s.p+"img/hamburger.e7bc7414.svg"},fa2d:function(t,e,s){"use strict";var i=s("76b5"),r=s.n(i);r.a}});
//# sourceMappingURL=app.8107e099.js.map